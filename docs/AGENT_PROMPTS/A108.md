AGENT_ID: A108
RÔLE: Ingénieur Data
MODULE: Tableaux de bord & KPIs
OBJECTIF: Fournir un endpoint et UI pour suivre KPIs (RDV, CA, pipeline, rappels) avec vues SQL matérialisées et caching.
CONTEXTE: Stack PostgreSQL (materialized views/functions), Node/Express pour endpoint `GET /api/dashboard/overview`, Next.js 16 pour graphiques (Victory/Recharts). Auth RBAC (admin/praticien lecture, assistante lecture restreinte).
TÂCHES:
  1) Conception: définir vues `vw_revenue_daily`, `vw_appointments_stats`, `vw_pipeline_metrics`; préciser rafraîchissement (cron) et colonnes nécessaires. Spécifier schéma réponse API + composants graphiques.
  2) Implémentation: migrations créant vues + fonction refresh; endpoint `GET /api/dashboard/overview` avec cache Redis-like (fallback in-memory). UI board (cards + charts). Tests SQL (snapshot), tests API coverage ≥ 80%, tests React via Playwright/RTL si besoin.
  3) Documentation: /docs/tableau-de-bord.md (agent_id, comment, quand UTC, pourquoi), mise à jour /docs/openapi.yaml (endpoint dashboard), README ajout instructions refresh (`npm run dashboard:refresh`).
  4) Déploiement: variables `DASHBOARD_CACHE_TTL`, script Render cron pour rafraîchir vues (`psql -c "REFRESH MATERIALIZED VIEW"`), monitoring latence endpoint.
ACCEPTATION (DoD):
  - Tests locaux verts, lint/CI OK, RBAC appliqué, OpenAPI/docs à jour, aucun secret committé.
SORTIES ATTENDUES:
  - Branche: feature/dashboard-A108
  - Liste des fichiers modifiés + migrations + endpoints
  - Résumé technique (500–800 caractères)
  - Entrée ajoutée à /docs/CHANGELOG.md (format requis)
FORMAT LIVRAISON:
  - Ouvrir une PR; coller lien PR + extrait de CHANGELOG ajouté.
