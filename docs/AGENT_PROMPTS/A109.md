AGENT_ID: A109
RÔLE: Ingénieur Backend
MODULE: Exports & conformité
OBJECTIF: Offrir des exports CSV/ZIP (patients, factures, paiements) sécurisés, traçables et respectant RGPD (expiration 24h).
CONTEXTE: Stack Node/Express + TypeScript + PostgreSQL (requêtes batch), stockage S3 temporaire pour fichiers, worker Render (job) pour génération asynchrone. Auth RBAC (admin uniquement par défaut).
TÂCHES:
  1) Conception: tables `exports`, `export_artifacts`; définir workflow (requested→processing→ready/failed), format fichiers, filtrage période, chiffrement optionnel (password). Documenter politiques RGPD.
  2) Implémentation: endpoints `POST /api/exports`, `GET /api/exports/:id`, job worker `npm run exports:worker` (Render background) qui lit queue, génère CSV/ZIP, charge sur S3 avec expiration 24h. Tests unitaires+intégration coverage ≥ 80% (mock S3, heavy queries pagination).
  3) Documentation: /docs/exports.md (agent_id, comment, quand UTC, pourquoi), mise à jour /docs/openapi.yaml, README section "Exports & DPA".
  4) Déploiement: variables `EXPORTS_BUCKET`, `EXPORTS_TTL_HOURS`, `EXPORTS_MAX_ROWS`; migrations SQL + seed sample, instructions Render pour worker et webhook de complétion (optionnel).
ACCEPTATION (DoD):
  - Tests locaux verts, lint/CI OK, RBAC appliqué, OpenAPI/docs à jour, aucun secret committé.
SORTIES ATTENDUES:
  - Branche: feature/exports-A109
  - Liste des fichiers modifiés + migrations + endpoints
  - Résumé technique (500–800 caractères)
  - Entrée ajoutée à /docs/CHANGELOG.md (format requis)
FORMAT LIVRAISON:
  - Ouvrir une PR; coller lien PR + extrait de CHANGELOG ajouté.
